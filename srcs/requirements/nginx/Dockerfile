FROM alpine:3.18.5

ARG DOMAIN_NAME=""
ARG PROXY_WP_IP_WP=""
ARG PROXY_ADMINER_IP_ADMINER=""
ARG PROXY_REACT_IP_REACT=""
ENV DOMAIN_NAME=${DOMAIN_NAME}
ENV PROXY_WP_IP_WP=${PROXY_WP_IP_WP}
ENV PROXY_ADMINER_IP_ADMINER=${PROXY_ADMINER_IP_ADMINER}
ENV PROXY_REACT_IP_REACT=${PROXY_REACT_IP_REACT}

EXPOSE 443

RUN apk update && apk upgrade

RUN apk add --no-cache nginx openssl gettext

COPY files/nginx.conf nginx.conf

RUN envsubst < nginx.conf > /etc/nginx/nginx.conf \
  '$DOMAIN_NAME,$PROXY_WP_IP_WP,$PROXY_ADMINER_IP_ADMINER,$PROXY_REACT_IP_REACT'

CMD ["nginx"]
